function CreatePartyController(a,b,c,d){"use strict";a.party=new c("",null,1e3),a.createParty=function(){a.saveParty(a.party)},a.saveParty=function(c){try{d.save(c).then(function(c){a.updatePartyList(),b.path("/party/"+c.id)})}catch(e){b.path("/error")}}}function EditCharacterController(a,b,c,d,e,f,g,h){"use strict";a.character=a.context.character,a.chooseAvatarMode=!1,a.ItemType=c,a.avatars=[],a.getCharacter=function(){return a.character},a.getAvailableRaces=function(){var b=a.getActiveParty();return e.getAvailableRaces(b)},a.getAvailableProfessions=function(){var b=a.getActiveParty();return f.getAvailableProfessions(b)},a.isWeapon=function(a){return a.isWeapon()},a.isArmor=function(a){return a.isArmor()},a.isRangedWeapon=function(a){return a.isRangedWeapon()};var i=function(a){var c=function(a){var c=b.defer(),d=new Image;return d.onload=function(){c.resolve(a)},d.src=h.getBackgroundImageUrl("."+a),c.promise};_.each(g,function(b){c(b).then(a)})};a.showAvailableAvatars=function(){i(function(b){a.avatars.push(b)}),a.chooseAvatarMode=!0},a.chooseAvatar=function(b){a.character.portrait=b,a.chooseAvatarMode=!1};var j=function(b,c){b!=c&&a.character.dropUnusableItems(d,a.getActiveParty())};a.$watch("character.profession",j),a.$watch("character.race",j)}function HomeController(){}function MainController(a,b,c,d,e,f,g,h){"use strict";var i="activePartyChanged",j="partyListChanged";a.topMenuSelected="home",a.lists=e,a.lookups=d,a.notifications=[],a.context={},h.setCollection(a.notifications);var k=function(){f.list().then(function(b){a.parties=b})};a.changeActiveParty=function(b){a.$emit(i,b)},a.updatePartyList=function(){a.$emit(j)},a.notifyDanger=function(a,b){h.notifyDanger(a,b)},a.notifyInfo=function(a,b){h.notifySuccess(a,b)},a.$on(j,function(){k()}),a.$on(i,function(b,c){a.context.activePartyId=c}),k()}function ManagePartyController(a,b,c,d,e,f,g,h,i){"use strict";var j=b.partyId;j&&(a.changeActiveParty(b.partyId),f.get(j).then(function(b){a.party=b})),a.state={deleteMode:!1,chiefSelection:!1,mageSelection:!1,action:"list_characters"},a.calcPartyCost=function(){return g.calculatePartyCost(a.party)},a.calcMemberCost=function(b){return g.calculatePartyMemberCost(b,a.party)},a.editCharacter=function(b){a.context.character=b,a.state.action="edit_character"},a.manageParty=function(){a.context.character=null,a.state.action="list_characters"},a.addCharacter=function(){var b=new i;a.party.addMember(b),a.editCharacter(b)},a.saveChanges=function(){f.save(a.party),a.updatePartyList(),a.notifyInfo("Drużyna zapisana pomyślnie!","Wszystkie wprowadzone zmiany zostały zapisane.")},a.applyCurrentAction=function(b,c){b.stopImmediatePropagation(),a.state.deleteMode&&(a.party.removeCharacter(c),a.state.deleteMode=!1),a.state.chiefSelection&&(a.party.setChief(c),c.dropUnusableItems(h,a.party),a.state.chiefSelection=!1),a.state.mageSelection&&(a.party.setMage(c),c.dropUnusableItems(h,a.party),a.state.mageSelection=!1)},a.canApplyCurrentAction=function(b){return a.state.deleteMode?!0:a.state.chiefSelection?a.party.canBeChief(b):a.state.mageSelection?a.party.canBeMage(b):!0},a.isInSpecialMode=function(){var b=a.state;return b.deleteMode||b.chiefSelection||b.mageSelection},a.toggleDeleteMode=function(b){a.state.deleteMode=b},a.toggleSelectionModeOff=function(){a.state.chiefSelection=!1,a.state.mageSelection=!1},a.destroyParty=function(){var b=function(a,b){a.ok=function(){b.close(!0)},a.cancel=function(){b.close(!1)}};b.$inject=["$scope","$modalInstance"];var c=e.open({templateUrl:"views/modals/destroyPartyConfirm.html",controller:b});c.result.then(function(b){return b?(f.remove(a.party).then(function(){a.updatePartyList(),d.path("/"),a.notifyInfo("Drużyna zniszczona.","Postacie nie żyją.")}),void 0):!1})},a.printParty=function(){var a=c.document.querySelector("[party-card-render] canvas"),b=a.toDataURL("image/png");c.open(b,"","")},a.isPartyValid=function(){return void 0===a.party.isValid?!0:a.party.isValid(g)},a.getActiveParty=function(){return a.party},a.$watch("isPartyValid()",function(b){b||a.notifyDanger("Przegiąłeś!","Zużyłeś zbyt wiele punktów. Napraw problem i zapisz drużynę.")})}function PartyListController(a){a.activateParty=function(b){a.changeActiveParty(b)}}function ExportController(a,b){"use strict";a.exportUrl=null,a.fileName=a.getActiveParty().name+".ut",a.refreshExportUrl=function(){var c=a.getActiveParty(),d=new Blob([angular.toJson(c)],{type:"application/octet-binary"});a.exportUrl=b.URL.createObjectURL(d)}}function ChooseItemsController(a,b,c,d,e){"use strict";var f,g;a.ItemType=e,f=function(a){return"function"==typeof a?a:"number"==typeof a?function(b){return b.type==a}:function(){return!0}},g=f(a.itemFilter),a.addItem=function(b){a.character.equipment.push(b.id)},a.removeItem=function(b){var c=a.character.equipment,d=c.indexOf(b.id);c.splice(d,1)},a.getCharactersItems=function(){return _(a.character.equipment).map(function(a){return b[a]}).filter(g).value()},a.getUsableItems=function(){return _.filter(c,function(b){return g(b)&&d.itemCanBeUsedBy(b,a.character,a.party)})}}function ImportPartyController(a,b){"use strict";var c=function(a){var c=b.defer(),d=new FileReader;return d.onloadend=function(a){c.resolve(a.target.result)},d.readAsText(a),c.promise};a.notifyImportError=function(){a.notifyDanger("Błąd importu","Niepoprawny format pliku.")},a.importParty=function(b){var d,e=b[0],f=function(b){if(!b)return a.notifyImportError(),void 0;try{d=angular.fromJson(b),d.id=null,a.saveParty(d)}catch(c){console.error(c),a.notifyImportError()}};c(e).then(f)}}angular.module("LocalStorageModule").value("prefix","ut"),angular.module("ut.backend.storage",["LocalStorageModule"]),angular.module("ut.backend",["ut.backend.storage","ngMockE2E"]),angular.module("ut.core",[]),angular.module("ut.core.constants",["ut.core"]),angular.module("ut.core.services",["ut.core.constants"]),angular.module("ut.helpers",[]),angular.module("ut.directives",["ut.helpers"]),angular.module("ut.filters",[]),angular.module("ut.services",["ut.core","ut.core.constants","ut.core.services","ngResource"]),angular.module("ut.core").factory("ArmorClass",[function(){"use strict";return{Light:1,Heavy:2}}]),angular.module("ut.core").factory("ItemType",[function(){"use strict";return{Helmet:1,Armor:2,Shield:3,Greaves:4,MeleeWeapon:5,RangedWeapon:6,Equipment:7}}]),angular.module("ut.core").factory("itemToItemUsabilityRules",["ArmorClass","ItemType",function(a,b){"use strict";var c,d,e,f,g=function(a,b){this.idempotent=a,this.check=b};return c=new g(!0,function(a,b){return a.id!=b.id}),d=new g(!1,function(a,c){return a.isA(b.MeleeWeapon)&&a.properties.isTwoHanded&&c.isA(b.Shield)?!1:!0}),e=new g(!1,function(a,c){return a.isA(b.Shield)&&c.isA(b.MeleeWeapon)&&c.properties.isLightweight?!1:!0}),f=function(a){return new g(!0,function(b,c){return b.type!=a||c.type!=a})},[c,d,e,f(b.Armor),f(b.Helmet),f(b.Shield),f(b.Greaves),f(b.Equipment)]}]),angular.module("ut.core").factory("characterRelatedUsabilityRules",["ArmorClass","ItemType",function(a){"use strict";var b=function(a){this.name=name,this.check=a},c=new b(function(b,c){return b.profession&&c.properties&&c.properties.armorClass&&c.properties.armorClass==a.Heavy?b.profession.cost>30:!0}),d=new b(function(a,b){return b.races&&b.races.length&&a.race&&!_.some(b.races,function(b){return b==a.race.id})?!1:!0}),e=new b(function(a,b){if(!b.isWeapon())return!0;var c=_.filter(a.equipment,function(a){return a.isWeapon()}).length;return 2>c}),f=function(a,c){return new b(function(b,d){return a(b)?d.id!=c:!0})},g=function(a){return a.isChief},h=function(a){return a.isMage};return[c,d,e,f(g,60),f(g,61),f(h,60),f(h,61)]}]),angular.module("ut.core").factory("partyRelatedUsabilityRules",["ArmorClass","ItemType",function(a,b){"use strict";var c=function(a){this.check=a},d=new c(function(a,c){if(c.type!=b.Equipment)return!0;var d=_(a.members).map(function(a){return a.equipment}).flatten().value(),e=_.filter(d,function(a){return a==c.id});return e.length<2}),e=function(a){return new c(function(b,c){return c.id!=a?!0:0==_(b.members).map(function(a){return a.equipment}).flatten().filter(function(b){return a==b}).value().length})};return[d,e(60),e(61)]}]),angular.module("ut.core").factory("ArmorProperties",["ArmorClass","ItemType",function(a,b){"use strict";var c=function(a){this.armorClass=a};return c.prototype.canBeUsedBy=function(c,d){var e=this,f=c.equipment;return _.some(f,function(a){return a.id==e.id})?!1:d.isA(b.Helmet)&&_.some(f,function(a){return a.isA(b.Helmet)})?!1:d.isA(b.Greaves)&&_.some(f,function(a){return a.isA(b.Greaves)})?!1:d.isA(b.Armor)&&_.some(f,function(a){return a.isA(b.Armor)})?!1:d.isA(b.Shield)&&(_.some(f,function(a){return a.isA(b.Shield)||a.isA(b.MeleeWeapon)&&(a.isTwoHanded||a.isLight)})||_.some(f,function(a){return a.isA(b.MeleeWeapon)}))?!1:e.armorClass==a.Heavy&&c.profession?c.profession.cost>30:!0},c}]),angular.module("ut.core").factory("MeleeWeaponProperties",["ItemType",function(){var a=function(a,b){var c=this;c.isTwoHanded=a,c.isLightweight=b};return a}]),angular.module("ut.core").factory("RangedWeaponProperties",["ItemType",function(){"use strict";var a=function(){};return a}]),angular.module("ut.core").factory("EquipmentProperties",["ItemType",function(){"use strict";var a=function(){};return a}]),angular.module("ut.core").factory("RaceAttributes",[function(){var a=function(a,b,c,d,e,f,g,h){this.command=a,this.mobility=b,this.normalCombat=c,this.strength=d,this.condition=e,this.rangeWeapons=f,this.toughness=g,this.vitality=h};return a}]),angular.module("ut.core").factory("uuid",[function(){"use strict";var a,b;return a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},b=function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}]),angular.module("ut.core").factory("Character",["uuid","itemsLookup",function(a,b){"use strict";var c=function(){this.id=a(),this.name=null,this.profession=null,this.race=null,this.equipment=[],this.portrait=null};return c.prototype.validate=function(){var a=[];return this.name||a.push("Imię jest wymagane."),this.race||a.push("Rasa jest wymagana."),this.profession||a.push("Profesja jest wymagana."),this.hasWeapon()||a.push("Postać musi mieć przynajmniej jedną broń."),a},c.prototype.isValid=function(){return 0==this.validate().length},c.prototype.getItems=function(){return _.map(this.equipment,function(a){return b[a]})},c.prototype.hasWeapon=function(){return _.some(this.getItems(),function(a){return a.isWeapon()||a.isRangedWeapon()})},c.prototype.dropUnusableItems=function(a,b){var c=this,d=c.getItems();c.equipment=[],c.equipment=_(d).filter(function(d){return a.itemCanBeUsedBy(d,c,b)}).map(function(a){return a.id}).value()},c}]),angular.module("ut.core").factory("Item",["ItemType","itemToItemUsabilityRules","characterRelatedUsabilityRules","partyRelatedUsabilityRules",function(a,b,c,d){"use strict";var e=function(a,b,c,d,e,f){var g=this;g.id=a,g.name=b,g.type=c,g.cost=d,g.properties=e,g.races=f};e.prototype.isWeapon=function(){return this.type==a.MeleeWeapon||this.type==a.RangedWeapon},e.prototype.isRangedWeapon=function(){return this.type==a.RangedWeapon},e.prototype.isArmor=function(){return this.type==a.Helmet||this.type==a.Shield||this.type==a.Greaves||this.type==a.Armor},e.prototype.isA=function(a){return this.type==a},e.prototype.isOneOf=function(){var a=this;return _.some(arguments,function(b){return b==a.type})};var f=function(a,b,c){return a.idempotent?a.check(b,c):a.check(b,c)&&a.check(c,b)};return e.prototype.canBeUsedWith=function(a){var c=this;return _.every(b,function(b){return f(b,c,a)})},e.prototype.canBeUsedBy=function(a){var b=this,e=_.every(d,function(c){return c.check(a.party,b)});if(!e)return!1;var f=_.every(c,function(c){return c.check(a.character,b)});if(!f)return!1;var g=_.every(a.character.equipment,function(a){return a.canBeUsedWith(b)});return g},e}]),window.angular.module("ut.core").factory("Party",[function(){"use strict";var a=function(a,b,c){this.id=null,this.name=a,this.nature=b,this.points=c,this.members=[],this.chief=null,this.mage=null};return a.prototype.removeCharacter=function(a){var b=this,c=b.members,d=c.indexOf(a);-1!==d&&c.splice(d,1)},a.prototype.canAddMember=function(){return this.members.length<=16},a.prototype.canBeMage=function(){},a.prototype.canBeChief=function(a){var b=function(a){return 5!=a.profession};return this.mage!=a.id&&b(a)},a.prototype.addMember=function(a){if(!this.canAddMember())throw"Cannot add another member.";this.members.push(a)},a.prototype.setChief=function(a){if(!this.canBeChief(a))throw"This member cannot be a chief.";this.chief=a.id},a.prototype.setMage=function(a){if(!this.canBeMage(a))throw"This member cannot be a mage.";this.mage=a.id},a.prototype.isChief=function(a){return this.chief==a.id},a.prototype.isMage=function(a){return this.mage==a.id},a.prototype.isValid=function(a){return a.calculatePartyCost(this)<this.points},a}]),angular.module("ut.core").factory("Profession",[function(){var a=function(a,b,c,d){this.id=a,this.name=b,this.cost=c,this.talent=d};return a}]),angular.module("ut.core").factory("Race",[function(){var a=function(a,b,c,d,e,f){this.id=a,this.name=b,this.cost=c,this.natures=d,this.talent=e,this.attributes=f};return a}]),angular.module("ut.core").factory("Nature",[function(){"use strict";var a=function(a,b){this.id=a,this.name=b};return a.prototype.getCompositeNatures=function(){return[this.id]},a}]),angular.module("ut.core").factory("MixedNature",[function(){var a=function(a,b,c){this.id=a,this.name=b,this.compositeNatures=c};return a.prototype.getCompositeNatures=function(){return this.compositeNatures},a}]),angular.module("ut.core.services",["ut.core.constants"]).factory("costCalculator",["lookups",function(a){"use strict";var b=function(){};return b.prototype.calculatePartyMemberCost=function(b,c){var d,e,f=0;if(d=_(c.members).filter(function(a){return a.profession===b.profession}).value(),e=_.indexOf(d,b),b.race&&(f+=a.races[b.race].cost),b.profession&&(f+=a.professions[b.profession].cost+10*(-1===e?0:e)),c.chief==b.id&&(f+=Math.ceil(a.professions[b.profession].cost/2)),b.equipment.length){var g=b.getItems(),h=0;f+=_.reduce(g,function(a,b){return b.isWeapon()&&(h+=1),a+=b.cost*(h>1?3:1)},0)}return f||0},b.prototype.calculatePartyCost=function(a){var b,c=this;return b=_.map(a.members,function(b){return c.calculatePartyMemberCost(b,a)}),0===b.length?0:_.reduce(b,function(a,b){return a+b})},new b(a.races,a.professions,a.items)}]),angular.module("ut.core.services").factory("usabilityDeterminator",["racesLookup","professionsLookup","itemsLookup",function(a,b){var c=function(c,d,e){var f={profession:b[d.profession],race:a[d.race],equipment:d.getItems(),isChief:e.chief==d.id,isMage:e.mage==d.id},g={character:f,party:e};return c.canBeUsedBy(g)};return{itemCanBeUsedBy:c}}]),angular.module("ut.services").factory("racesProvider",["races","natures",function(a,b){"use strict";var c=function(c){var d=_.find(b,function(a){return c.nature==a.id}),e=d.getCompositeNatures();return _.filter(a,function(a){return _.some(a.natures,function(a){return _.some(e,function(b){return b==a})})})};return{getAvailableRaces:c}}]),angular.module("ut.services").factory("professionsProvider",["professions",function(a){"use strict";var b=5,c=function(a){return a.profession==b},d=function(d){return _.some(d.members,c)?_.filter(a,function(a){return a.id!==b}):a};return{getAvailableProfessions:d}}]),angular.module("ut.core").factory("natures",["Nature","MixedNature",function(a,b){return[new a(1,"Dobry"),new b(4,"Praworządny",[1,2]),new a(2,"Neutralny"),new b(5,"Anarchia",[2,3]),new a(3,"Zły")]}]),angular.module("ut.core").factory("races",["Race","RaceAttributes",function(a,b){return[new a(1,"Elf leśny",62,[1],"Skradanie",new b(7,15,7,7,8,8,7,6)),new a(2,"Elf wyniosły",62,[2],"Taktyczna przewaga",new b(7,15,7,7,8,8,7,6)),new a(3,"Elf ciemny",62,[3],"Agresywna szarża",new b(7,15,7,7,8,8,7,6)),new a(4,"Elf dziki",62,[2],"Doskok",new b(7,15,7,7,8,8,7,6)),new a(5,"Krasnolud z Thargomind",66,[2],"Ogłuszanie",new b(6,15,7,8,6,7,8,8)),new a(6,"Krasnolud z Północy",66,[3],"Mściwość",new b(6,15,7,8,6,7,8,8)),new a(7,"Człowiek z Morten",55,[1,2,3],"Instynkt obronny",new b(7,15,7,7,7,7,7,7)),new a(8,"Człowiek z Borii",55,[1,2,3],"Wiara",new b(7,15,7,7,7,7,7,7)),new a(9,"Człowiek z Vartevii",55,[1,2,3],"Niewrażliwość",new b(7,15,7,7,7,7,7,7)),new a(10,"Człowiek z Estanii",55,[1,2,3],"Zabójcza precyzja",new b(7,15,7,7,7,7,7,7)),new a(11,"Człowiek z Undorh",55,[1,2,3],"Szał",new b(7,15,7,7,7,7,7,7)),new a(12,"Ork z Ugruk-hor",53,[2,3],"Brutalność",new b(6,15,6,8,6,6,8,7)),new a(13,"Ork Leśny",53,[2,3],"Szamanizm",new b(6,15,6,8,6,6,8,7)),new a(14,"Czarny ork",69,[3],"Rozszarpanie",new b(5,10,6,9,6,5,8,9)),new a(15,"Niziołek Krótkin",38,[1],"Zręczność",new b(6,20,6,6,8,7,6,5)),new a(16,"Niziołek Mrokin",38,[3],"Złorzeczenie",new b(6,20,6,6,8,7,6,5)),new a(17,"Goblin Miejski",39,[2,3],"Żywotność",new b(6,20,6,6,8,7,6,5)),new a(18,"Goblin Dziki",39,[2,3],"Szaleństwo",new b(6,20,6,6,8,7,6,5)),new a(19,"Hobgoblin",47,[3],"Przeznaczenie",new b(6,15,6,7,7,7,6,7)),new a(20,"Gnom",50,[1],"Wrodzona moc",new b(7,15,6,7,6,8,6,6)),new a(21,"Półogr",75,[1,2],"Twarda skóra",new b(7,10,6,9,6,5,9,9)),new a(22,"Tigerianin",70,[1],"Powalenie",new b(6,15,6,8,8,5,8,7)),new a(23,"Vorak",72,[2],"Podstępny cios",new b(5,15,7,6,8,8,7,8)),new a(24,"Mroczny Faun",77,[3],"Okrucieństwo",new b(6,15,6,8,6,6,8,9))]}]),angular.module("ut.core").factory("professions",["Profession",function(a){return[new a(1,"Akolita",14,"Posługa"),new a(2,"Alchemik",59,"Eliksiry"),new a(3,"Banita",21,"Przebiegłość"),new a(4,"Barbarzyńca",28,"Krzepa"),new a(5,"Bard",21,"Poetyckie kroniki"),new a(6,"Berserker",50,"Szał"),new a(7,"Czarny Rycerz",55,"Aura Śmierci"),new a(8,"Czarodziej",61,"Rzucanie czarów"),new a(9,"Czempion Królewski",40,"Wyspecjalizowanie"),new a(10,"Druid",58,"Magiczny Menhir"),new a(11,"Fałszywy Prorok",55,"Przeklęte Wizje"),new a(12,"Giermek",18,"Odwrócenie uwagi"),new a(13,"Gladiator",25,"Słaby punkt"),new a(14,"Gwardzista",32,"Natarcie"),new a(15,"Hiena cmentarna",16,"Znawca nekropolii"),new a(16,"Kapłan",62,"Święta walka"),new a(17,"Kleryk",55,"Modlitwy"),new a(18,"Korsarz",35,"Zuchwała szarża"),new a(19,"Łapserdak",8,""),new a(20,"Łowca Czarownic",44,"Polowanie"),new a(21,"Łowca Głów",29,"Atak na czerep"),new a(22,"Łowca Nagród",31,"Wielka szansa"),new a(23,"Mistrz Łuku",35,"Sokole oko"),new a(24,"Mistrz miecza",39,"Perfekcja"),new a(25,"Mnich",21,"Znawca świątyń"),new a(26,"Nożownik",26,"Zasztyletowanie"),new a(27,"Paladyn",55,"Aura Inspiracji"),new a(28,"Podstępny kupiec",28,"Handlowanie"),new a(29,"Przepatrywacz",29,"Znawca tropów"),new a(30,"Rozbójnik",31,"Atak z zaskoczenia"),new a(31,"Rusznikarz",28,"Rusznikarstwo"),new a(32,"Rycerz zakonny",55,"Zakonna determinacja"),new a(33,"Sierżant Strażników",27,"Chronić i służyć"),new a(34,"Skald",19,"Bitewne pieśni"),new a(35,"Skrytobójca",39,"Perfekcyjne zabójstwo"),new a(36,"Strażnik Kniei",25,"Terenoznawstwo"),new a(37,"Strzelec",19,"Strzał w ruchu"),new a(38,"Szaman",57,"Rytuał"),new a(39,"Szampierz",34,"Zamaszyste cięcie"),new a(40,"Szarlatan",23,"Obłędna gadanina"),new a(41,"Szermierz",34,"Zastawa"),new a(42,"Topornik",23,"Siła ostrza"),new a(43,"Uliczny Sędzia",55,"Ja jestem PRAWEM!!!"),new a(44,"Uczeń Czarodzieja",34,"Przyuczenie"),new a(45,"Wielki Łowczy",24,"Terenoznawstwo"),new a(46,"Wojownik klanu",27,"Rytualna walka"),new a(47,"Wróżbita",18,"Przewidywanie"),new a(48,"Zabójca",29,"Perfekcyjny atak"),new a(49,"Zbrojny",31,"Wyszkolenie"),new a(50,"Zielarz",18,"Warzenia naparów/trucizn"),new a(51,"Złodziej",20,"Doliniarstwo"),new a(52,"Zwadźca",35,"Dwie bronie"),new a(53,"Zwiadowca",24,"Skradanie")]}]),angular.module("ut.core").factory("items",["Item","ItemType","MeleeWeaponProperties","ArmorProperties","RangedWeaponProperties","EquipmentProperties","ArmorClass",function(a,b,c,d,e,f,g){"use strict";return[new a(1,"Miecz",b.MeleeWeapon,11,new c(!1,!1)),new a(2,"Miecz krótki",b.MeleeWeapon,11,new c(!1,!1)),new a(3,"Topór",b.MeleeWeapon,8,new c(!1,!1)),new a(4,"Sejmitar",b.MeleeWeapon,8,new c(!1,!1)),new a(5,"Młot",b.MeleeWeapon,10,new c(!1,!1)),new a(6,"Morgenstern",b.MeleeWeapon,10,new c(!1,!1)),new a(7,"Szabla",b.MeleeWeapon,14,new c(!1,!1)),new a(8,"Rapier",b.MeleeWeapon,14,new c(!1,!1)),new a(9,"Włócznia",b.MeleeWeapon,13,new c(!1,!1)),new a(10,"Maczuga",b.MeleeWeapon,6,new c(!1,!1)),new a(11,"Pałka",b.MeleeWeapon,6,new c(!1,!1)),new a(12,"Widły",b.MeleeWeapon,5,new c(!1,!1)),new a(13,"Kij",b.MeleeWeapon,5,new c(!1,!1)),new a(14,"Miecz półtoraręczny",b.MeleeWeapon,28,new c(!0,!1)),new a(15,"Miecz dwuręczny",b.MeleeWeapon,27,new c(!0,!1)),new a(16,"Topór dwuręczny",b.MeleeWeapon,26,new c(!0,!1)),new a(17,"Młot dwuręczny",b.MeleeWeapon,27,new c(!0,!1)),new a(18,"Halabarda",b.MeleeWeapon,24,new c(!0,!1)),new a(19,"Korbacz",b.MeleeWeapon,24,new c(!0,!1)),new a(20,"Kostur",b.MeleeWeapon,6,new c(!0,!1)),new a(21,"Sztylet",b.MeleeWeapon,5,new c(!1,!0)),new a(22,"Nóż",b.MeleeWeapon,2,new c(!1,!0)),new a(23,"Asari Tiheri",b.MeleeWeapon,32,new c(!0,!1),[22]),new a(24,"Topór Groma",b.MeleeWeapon,38,new c(!0,!1),[6]),new a(25,"Młot Asmunda",b.MeleeWeapon,43,new c(!1,!1),[5]),new a(26,"Ussarous",b.MeleeWeapon,25,new c(!1,!1),[23]),new a(27,"Łuk",b.RangedWeapon,14,new e),new a(28,"Długi łuk",b.RangedWeapon,19,new e),new a(29,"Kusza",b.RangedWeapon,17,new e),new a(30,"Kusza powtarzalna",b.RangedWeapon,21,new e),new a(31,"Proca",b.RangedWeapon,3,new e),new a(32,"Strzelba",b.RangedWeapon,26,new e),new a(33,"Garłacz",b.RangedWeapon,22,new e),new a(34,"Armatka",b.RangedWeapon,16,new e,[15,16,17,18]),new a(35,"Noże do rzucania",b.RangedWeapon,12,new e),new a(36,"Bomba",b.RangedWeapon,13,new e),new a(37,"Łuk Morrenviel",b.RangedWeapon,26,new e,[1,2,3,4]),new a(38,"Kusza Zagłady",b.RangedWeapon,21,new e,[19]),new a(39,"Proca Króla Oprychów",b.RangedWeapon,9,new e,[15,16]),new a(40,"Plugawy Garłacz",b.RangedWeapon,28,new e,[12,13,14]),new a(41,"Hełm lekki",b.Helmet,4,new d(g.Light)),new a(42,"Hełm ciężki",b.Helmet,7,new d(g.Heavy)),new a(43,"Koszulka kolcza",b.Armor,4,new d(g.Light)),new a(44,"Napierśnik płytowy",b.Armor,7,new d(g.Heavy)),new a(45,"Nagolennik skórzany",b.Greaves,4,new d(g.Light)),new a(46,"Nagolennik metalowy",b.Greaves,7,new d(g.Heavy)),new a(47,"Tarcza drewniana",b.Shield,3,new d(g.Light)),new a(48,"Tarcza stalowa",b.Shield,10,new d(g.Heavy)),new a(49,"Lina",b.Equipment,1,new f),new a(50,"Latarnia/pochodnia",b.Equipment,3,new f),new a(51,"Hubka i krzesiwo",b.Equipment,2,new f),new a(52,"Leczący eliksir",b.Equipment,5,new f),new a(53,"Trucizna",b.Equipment,3,new f),new a(54,"Zioła",b.Equipment,1,new f),new a(55,"Talizman przeznaczenia",b.Equipment,7,new f),new a(56,"Bitewny relikt",b.Equipment,3,new f),new a(57,"Peleryna tropiciela",b.Equipment,8,new f),new a(58,"Szkiełko",b.Equipment,1,new f),new a(59,"Amulet Odwagi",b.Equipment,4,new f),new a(60,"Trofeum/totem",b.Equipment,8,new f),new a(61,"Róg",b.Equipment,5,new f),new a(62,"Maska zabójcy",b.Equipment,6,new f),new a(63,"Groty przeciwpancerne",b.Equipment,4,new f),new a(64,"Groty zapalające",b.Equipment,5,new f),new a(65,"Groty łowieckie",b.Equipment,6,new f)]}]),angular.module("ut.core.constants").factory("avatars",[function(){return["armored-1","armored-2","armored-3","armored-4","armored-5","armored-6","cyberpunk-1","cyberpunk-2","cyberpunk-3","cyberpunk-4","cyberpunk-5","cyberpunk-6","cyberpunk-7","cyberpunk-8","cyberpunk-9","dwarf-1","dwarf-2","dwarf-3","dwarf-4","dwarf-5","dwarf-6","elf-1","elf-2","elf-3","elf-4","elf-5","elf-6","elf-7","elf-8","elf-9","gnome-1","gnome-2","hero-1","hero-2","hero-3","human-1","human-2","human-3","human-4","human-5","human-6","human-7","human-8","human-9","ithilid-1","mad-scientist-1","mad-scientist-2","manimal-1","manimal-2","manimal-3","manimal-4","manimal-5","manimal-6","manimal-7","manimal-8","manimal-9","pirate-1","pirate-2","pirate-3","pirate-4","pirate-5","pirate-6","pirate-7","robot-1","robot-2","robot-3","robot-4","robot-5","robot-6","robot-7","robot-8","robot-9","scary-1","scary-2","scary-3","scary-4","scary-5","scary-6","scary-7","steampunk-1","steampunk-2","steampunk-3","steampunk-4","steampunk-5","steampunk-6","steampunk-7","toon-1","troll-1","troll-2","troll-3","troll-4","troll-5","troll-6","troll-7","troll-8","troll-9","vampire-1","vampire-2","vampire-3","vampire-4","vampire-5","zombie-1","zombie-2","zombie-3","zombie-4","zombie-5","zombie-6","zombie-7"]}]),angular.module("ut.core.constants").factory("enumerations",["natures","races","professions","items",function(a,b,c,d){"use strict";return{natures:a,races:b,professions:c,items:d}}]),angular.module("ut.core").factory("_buildLookupFromList",[function(){"use strict";var a=function(a){for(var b={},c=0;c<a.length;c++)b[a[c].id]=a[c];return b};return a}]).factory("racesLookup",["_buildLookupFromList","enumerations",function(a,b){"use strict";return a(b.races)}]).factory("professionsLookup",["_buildLookupFromList","enumerations",function(a,b){"use strict";return a(b.professions)}]).factory("itemsLookup",["_buildLookupFromList","enumerations",function(a,b){"use strict";return a(b.items)}]).factory("naturesLookup",["_buildLookupFromList","enumerations",function(a,b){"use strict";return a(b.natures)}]).factory("lookups",["racesLookup","professionsLookup","itemsLookup",function(a,b,c){"use strict";return{races:a,professions:b,items:c}}]);var angular=window.angular,_=window._;angular.module("ut.services").factory("partyRepository",["$q","$resource","Party","Character",function(a,b,c,d){"use strict";var e,f;return e=b("/party/:partyId",{partyId:"@id"}),f={save:function(b){var c=a.defer(),d=new e(b);return d.$save(function(a){c.resolve(a)}),c.promise},get:function(b){var f,g=a.defer();return f=e.get({id:b},function(a){a=angular.extend(new c,a),a.members=_.map(a.members,function(a){return angular.extend(new d,a)}),g.resolve(a)}),g.promise},remove:function(b){var c=a.defer();return b.id?(e.delete({id:b.id}).$promise.then(function(){c.resolve()}),c.promise):(c.resolve(),c.promise)},list:function(){var b=a.defer();return e.query().$promise.then(function(a){var c=_.sortBy(a,function(a){return a.name.toUpperCase()});b.resolve(c)}),b.promise}}}]),angular.module("ut.services").factory("notificationService",["$q","$timeout",function(a,b){"use strict";var c,d,e=3e3,c=function(){this.notifications=null},d=function(a,c,d,f){if(!a)throw"Notifications collection was not initiated.";a.push({title:c,text:d,type:f}),b(function(){a.pop()},e)};return c.prototype.notifyDanger=function(a,b){d(this.notifications,a,b,"danger")},c.prototype.notifySuccess=function(a,b){d(this.notifications,a,b,"success")},c.prototype.setCollection=function(a){this.notifications=a},new c}]);var angular=window.angular,_=window._;angular.module("ut.helpers").factory("cssHelper",[function(){"use strict";var a,b;return a=function(a){return _(document.styleSheets).map(function(a){return a.rules||a.cssRules}).map(function(b){return _.find(b,function(b){return b.selectorText===a})||null}).map(function(a){return a?a.style:null}).compact().first()||null},b=function(b){var c=a(b);return c?c.backgroundImage.replace(/^url\(["']?/,"").replace(/["']?\)$/,""):null},{getBackgroundImageUrl:b}}]),angular.module("ut.directives").directive("staticInclude",["$http","$templateCache","$compile",function(a,b,c){"use strict";return function(d,e,f){var g=f.staticInclude;a.get(g,{cache:b}).success(function(a){var b=$("<div/>").html(a).contents();e.html(b),c(b)(d)})}}]),angular.module("ut.directives").directive("itemsChooser",[function(){"use strict";return{restrict:"E",controller:"ChooseItemsController",scope:{itemFilter:"=itemFilter",character:"=character",displayType:"=displayType",party:"=party"},transclude:!0,templateUrl:"views/templates/items-chooser.html"}}]),angular.module("ut.directives").directive("partyCardRender",["$q","naturesLookup","racesLookup","professionsLookup","itemsLookup","cssHelper",function(a,b,c,d,e,f){"use strict";var g=".party-card",h=function(a,b,c){this.x=a,this.y=b,this.maxWidth=c||null},i=function(a,b,c){return new h(a,b,c)},j=[i(3,125),i(3,587),i(3,1048),i(1034,125),i(1034,587),i(1034,1048)],k={name:i(24,300),race:i(24,353),profession:i(24,406),raceSkill:i(335,353),professionSkill:i(335,406),ld:i(380,35),m:i(380,69),ws:i(380,103),s:i(380,137),sp:i(380,171),bs:i(380,205),t:i(380,239),w:i(380,273),weapon:i(437,50),armor:i(437,138),equipment:i(437,225),psychology:i(592,335),portraitStart:i(57,10),portraitEnd:i(258,248)},l={partyName:i(20,75),nature:i(460,75),guild:i(1255,75),points:i(1550,75)},m=function(b){var c=a.defer(),d=new Image;return d.onload=function(){c.resolve(d)},d.src=b,c.promise},n=m(f.getBackgroundImageUrl(g)),o=function(a,g){if(a.party){var i=document.createElement("canvas");g.append(i),a.$watch("party",function(a){n.then(function(b){o(b,a)})},!0);var o=function(a,g){i.width=a.width,i.height=a.height;var n=i.getContext("2d");n.drawImage(a,0,0),n.font="18px Georgia";var o=function(a,b){n.fillText(a,b.x,b.y)},p=function(a,b,c){n.drawImage(a,0,0,a.width,a.height,b.x,b.y,c.x-b.x,c.y-b.y)};o(g.name,l.partyName),o(g.nature?b[g.nature].name:"",l.nature),o(g.guild,l.guild),o(g.points,l.points);var q=function(a,b){var g=function(a){return new h(a.x+b.x,a.y+b.y)},i=function(a,b){o(a,g(b))},j=function(){var b=f.getBackgroundImageUrl("."+a.portrait);m(b).then(function(a){p(a,g(k.portraitStart),g(k.portraitEnd))})};i(a.name,k.name);var l=c[a.race],n=d[a.profession];if(l){var q=l.attributes;i(l.name,k.race),i(l.talent,k.raceSkill),i(q.command,k.ld),i(q.mobility,k.m),i(q.normalCombat,k.ws),i(q.strength,k.s),i(q.condition,k.sp),i(q.rangeWeapons,k.bs),i(q.toughness,k.t),i(q.vitality,k.w)}n&&(i(n.name,k.profession),i(n.talent,k.professionSkill));var r=function(b){return _(a.equipment).map(function(a){return e[a]}).filter(b).map(function(a){return a.name}).value().join(", ")},s=r(function(a){return a.isWeapon()}),t=r(function(a){return a.isArmor()});i(s,k.weapon),i(t,k.armor),i("?",k.equipment),i("?",k.psychology),j()};_.each(g.members,function(a,b){b>5||q(g.members[b],j[b])})}}};return{restrict:"A",transclude:!0,link:o}}]),angular.module("ut.directives").directive("contenteditable",function(){"use strict";return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){function e(){var a=b.html();c.stripBr&&"<br>"==a&&(a=""),d.$setViewValue(a)}d&&(d.$render=function(){b.html(d.$viewValue||"")},b.on("blur keyup change",function(){a.$apply(e)}),e())}}}),angular.module("ut.directives").directive("forwardClick",["$document",function(){"use strict";return{restrict:"A",link:function(a,b,c){var d=c.forwardClick,e=document.querySelector(d);b.bind("click",function(){e.click()})}}}]),CreatePartyController.$inject=["$scope","$location","Party","partyRepository"],EditCharacterController.$inject=["$scope","$q","ItemType","usabilityDeterminator","racesProvider","professionsProvider","avatars","cssHelper"],HomeController.$inject=[],MainController.$inject=["$scope","$location","$routeParams","lookups","enumerations","partyRepository","costCalculator","notificationService"],ManagePartyController.$inject=["$scope","$routeParams","$window","$location","$modal","partyRepository","costCalculator","usabilityDeterminator","Character"],PartyListController.$inject=["$scope","$location","$routeParams"],ExportController.$inject=["$scope","$window"],ChooseItemsController.$inject=["$scope","itemsLookup","items","usabilityDeterminator","ItemType"],ImportPartyController.$inject=["$scope","$q"];var angular=window.angular,_=window._;angular.module("ut.backend.storage").factory("storageService",["localStorageService",function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n="_ids",o=!1;return b=function(a){return{id:a.id,name:a.name}},c=function(a){return a.id},d=function(a,b){return a===b},e=function(a){return a+n},f=function(b){var c=a.get(e(b));return angular.fromJson(c)||[]},g=function(b,c){a.set(e(b),angular.toJson(c))},h=function(a){var b,d;return b=_(f(a)||[]).map(c).value(),d=b.length?_.max(b)+1:0,d+1
},i=function(a,b){return a+"_"+(b||h(a))},k=function(b,c){return angular.fromJson(a.get(i(b,c)))},l=function(b,c){a.remove(i(b,c));var d=_.filter(f(b),function(a){return a.id!==c});g(b,d)},j=function(c,d){var e,j;if(o)throw"!";return o=!0,e=f(c)||[],d.id?(j=_.find(e,function(a){return a.id===d.id}),j.name=d.name):(d.id=h(c),e.push(b(d)),g(c,e)),g(c,e),a.set(i(c,d.id),d),o=!1,d},m=function(a){return f(a)},{load:k,save:j,list:m,remove:l}}]);var angular=window.angular;window.angular.module("ut.backend").run(["$httpBackend","storageService",function(a,b){"use strict";a.whenGET(/^\/?party\/?\?id=[0-9]+/).respond(function(a,c){var d=parseInt(c.match(/^\/?party\/?\?id=([0-9]+)/)[1],10),e=b.load("party",d);return[200,angular.toJson(e)]}),a.when("GET",/^\/?party\/?/,'{"isArray":true}').respond(function(){var a=b.list("party");return[200,angular.toJson(a)]}),a.whenPOST(/^\/?party\/?([0-9]+)?\/?/).respond(function(a,c,d){var e=b.save("party",angular.fromJson(d));return[200,angular.toJson(e)]}),a.whenDELETE(/^\/?party\/?\?id=[0-9]+/).respond(function(a,c){var d=parseInt(c.match(/^\/?party\/?\?id=([0-9]+)/)[1],10),e=b.remove("party",d);return[200,angular.toJson(e)]}),a.whenGET(/^views\//).passThrough()}]),angular.module("utPartyManagerApp",["ngRoute","ngCookies","ngResource","ngSanitize","ngAnimate","ui.bootstrap","angularFileUpload","ut.core","ut.core.constants","ut.core.services","ut.filters","ut.services","ut.directives","ut.backend"]).config(["$compileProvider","$routeProvider",function(a,b){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|blob):/),b.when("/",{templateUrl:"views/home.html",controller:HomeController}).when("/party",{templateUrl:"views/party/create.html",controller:CreatePartyController}).when("/party/:partyId",{templateUrl:"views/party/manage.html",controller:ManagePartyController}).when("/notfound",{templateUrl:"views/notfound.html"}).when("/error",{templateUrl:"views/error.html"}).when("/about",{templateUrl:"views/about.html"}).otherwise({redirectTo:"/"})}]);